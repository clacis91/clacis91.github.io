{"componentChunkName":"component---src-templates-blog-post-js","path":"/8/","webpackCompilationHash":"a26b0d7def9a1629a68c","result":{"data":{"site":{"siteMetadata":{"title":"(대충 공부한거 적는다는 제목)","author":"WJNAM"}},"markdownRemark":{"id":"82004eb0-1b5d-5e4b-a291-6dfb6abc9070","excerpt":"객체지향 생각해보기 - 밴픽 (1)\n객체지향 생각해보기 - 밴픽 (2)ContinuedTODO list게임이 성립되려면 챔피언 3명으로는 부족하다. 챔피언 갯수를 늘려서 밴픽을 진행해보자.챔피언은 100종류가 넘는다. 이걸 일일히 코드상에서 추가해줄 수는 없다.-> DB…","html":"<p><a href=\"../1\">객체지향 생각해보기 - 밴픽 (1)</a>\n<a href=\"../3\">객체지향 생각해보기 - 밴픽 (2)</a></p>\n<h2>Continued</h2>\n<ul>\n<li>\n<p>TODO list</p>\n<ul>\n<li>게임이 성립되려면 챔피언 3명으로는 부족하다. 챔피언 갯수를 늘려서 밴픽을 진행해보자.</li>\n<li>챔피언은 100종류가 넘는다. 이걸 일일히 코드상에서 추가해줄 수는 없다.<br>\n-> DB(일단은 파일형태)에 챔피언 정보를 추가하는 것 만으로도 챔피언 풀에 추가돼야한다.</li>\n<li>지금은 챔피언 정보에 이름만 들어가지만 언제 갑자기 추가적인 정보가 필요해질지 모른다.<br>\n-> 챔피언 생성 과정에서 챔피언 객체와 관련된 의존성을 최대한 제거해야 한다.</li>\n</ul>\n</li>\n</ul>\n<h3>ChampionPoolGenerator</h3>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token comment\">// Room Class</span>\n<span class=\"token keyword\">private</span> <span class=\"token keyword\">void</span> <span class=\"token function\">initChampionPool</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    championPool <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ChampionPool</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token class-name\">Champion</span> garen <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Champion</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"가렌\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> \n    <span class=\"token class-name\">Champion</span> ashe <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Champion</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"애쉬\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token class-name\">Champion</span> ahri <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Champion</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"아리\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    championPool<span class=\"token punctuation\">.</span><span class=\"token function\">registerChampions</span><span class=\"token punctuation\">(</span>garen<span class=\"token punctuation\">,</span> ashe<span class=\"token punctuation\">,</span> ahri<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>기존 단계에서 챔피언 풀을 생성하는 동작을 Room 객체에서 수행하고 있었다. 이 동작은 엄밀히 보면 <b>(1)챔피언 풀을 생성</b>하고 <b>(2)생성된 챔피언 풀을 Room에 등록</b>하는 두가지 일을 한번에 수행하고 있기 때문에 적절치 않다. Room 객체에서는 만들어진 챔피언 풀을 가져다 쓰기만 하는게 맞다. 때문에 챔피언 풀을 생성하는 클래스를 새로 만들기로 했다.</p>\n<p>챔피언 풀을 생성하는 클래스는 이전처럼 챔피언 정보를 코드에 일일히 입력해서 등록하는게 아니라 DB에서 읽어와서 등록하는 방식으로 수정했다. (현재 단계에서는 간단한 text file로 DB를 흉내냄, 한줄 당 챔피언 이름 하나가 적혀있음)</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">import</span> <span class=\"token namespace\">java<span class=\"token punctuation\">.</span>io</span><span class=\"token punctuation\">.</span><span class=\"token class-name\">BufferedReader</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">java<span class=\"token punctuation\">.</span>io</span><span class=\"token punctuation\">.</span><span class=\"token class-name\">File</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">java<span class=\"token punctuation\">.</span>io</span><span class=\"token punctuation\">.</span><span class=\"token class-name\">FileNotFoundException</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">java<span class=\"token punctuation\">.</span>io</span><span class=\"token punctuation\">.</span><span class=\"token class-name\">FileReader</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">java<span class=\"token punctuation\">.</span>io</span><span class=\"token punctuation\">.</span><span class=\"token class-name\">IOException</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">java<span class=\"token punctuation\">.</span>util</span><span class=\"token punctuation\">.</span><span class=\"token class-name\">Iterator</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">java<span class=\"token punctuation\">.</span>util<span class=\"token punctuation\">.</span>stream</span><span class=\"token punctuation\">.</span><span class=\"token class-name\">Stream</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">ChampionPoolGenerator</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">String</span> CHAMPION_DB_FILE <span class=\"token operator\">=</span> <span class=\"token string\">\"champion.db\"</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">private</span> <span class=\"token class-name\">Stream</span> dbStream<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">private</span> <span class=\"token class-name\">ChampionPool</span> championPool<span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">ChampionPoolGenerator</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        championPool <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ChampionPool</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">ChampionPool</span> <span class=\"token function\">generate</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        dbStream <span class=\"token operator\">=</span> <span class=\"token class-name\">DBReader</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>dbStream <span class=\"token operator\">==</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Champion DB error!\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">return</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n\n        <span class=\"token class-name\">Iterator</span> iter <span class=\"token operator\">=</span> dbStream<span class=\"token punctuation\">.</span><span class=\"token function\">iterator</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">while</span><span class=\"token punctuation\">(</span>iter<span class=\"token punctuation\">.</span><span class=\"token function\">hasNext</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token class-name\">Champion</span> champion <span class=\"token operator\">=</span> <span class=\"token function\">parseChampion</span><span class=\"token punctuation\">(</span>iter<span class=\"token punctuation\">.</span><span class=\"token function\">next</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            championPool<span class=\"token punctuation\">.</span><span class=\"token function\">registerChampions</span><span class=\"token punctuation\">(</span>champion<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n        <span class=\"token keyword\">return</span> championPool<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">private</span> <span class=\"token class-name\">Champion</span> <span class=\"token function\">parseChampion</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Object</span> iter<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token class-name\">String</span> line <span class=\"token operator\">=</span> <span class=\"token class-name\">String</span><span class=\"token punctuation\">.</span><span class=\"token function\">valueOf</span><span class=\"token punctuation\">(</span>iter<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Champion</span><span class=\"token punctuation\">(</span>line<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">private</span> <span class=\"token class-name\">Stream</span> <span class=\"token class-name\">DBReader</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token class-name\">BufferedReader</span> br <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">BufferedReader</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">FileReader</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">File</span><span class=\"token punctuation\">(</span>CHAMPION_DB_FILE<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">return</span> br<span class=\"token punctuation\">.</span><span class=\"token function\">lines</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">FileNotFoundException</span> e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            e<span class=\"token punctuation\">.</span><span class=\"token function\">printStackTrace</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span> \n        <span class=\"token keyword\">return</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token comment\">// Room.java</span>\n<span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n<span class=\"token keyword\">public</span> <span class=\"token class-name\">Room</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">LolMap</span> map<span class=\"token punctuation\">,</span> <span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Summoner</span><span class=\"token punctuation\">></span></span> summoners<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token class-name\">ChampionPoolGenerator</span> championPoolGenerator <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ChampionPoolGenerator</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>map <span class=\"token operator\">=</span> map<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>summoners <span class=\"token operator\">=</span> summoners<span class=\"token punctuation\">;</span>\n    <span class=\"token comment\">//initChampionPool();</span>\n    <span class=\"token comment\">//=></span>\n    championPool <span class=\"token operator\">=</span> championPoolGenerator<span class=\"token punctuation\">.</span><span class=\"token function\">generate</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    banList <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ArrayList</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    pickList <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ArrayList</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span></code></pre></div>\n<p>기존 Room 객체 안에서 init 메소드로 챔피언 풀을 초기화하던 방식에서 ChampionPoolGenerator로 챔피언 풀 인스턴스를 생성하여 관리하도록 변경하였다.</p>\n<p>ChampionPoolGenerator 구현시 신경쓴 부분이 있는데, 한 클래스 안에서도 DB로부터 챔피언 정보를 불러오는 메소드와 챔피언 풀 객체를 생성하는 메소드를 분리해야한다는 점이었다.</p>\n<p>현재 DB는 허접한 File IO 방식으로 구현되어 있지만, 언제 갑자기 열정이 샘솟아서 DBMS를 활용해서 DB를 구축하게 될지 모르는 일이다. 하지만 챔피언 풀을 생성하는 메소드는 DB가 file이건, MySQL이건, MongoDB건 상관하지 않고 원하는 형태로 데이터가 들어오기만 하면 챔피언 풀 객체를 생성할 수 있어야한다. </p>\n<p>기왕 메소드 기능을 분리시킨김에 아예 클래스를 나눠버렸다.</p>\n<h3>ChampionDBManager</h3>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">import</span> <span class=\"token namespace\">java<span class=\"token punctuation\">.</span>util<span class=\"token punctuation\">.</span>stream</span><span class=\"token punctuation\">.</span><span class=\"token class-name\">Stream</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">interface</span> <span class=\"token class-name\">ChampionDBManager</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">Champion</span> <span class=\"token function\">parseChampion</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Object</span> iter<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">Stream</span> <span class=\"token class-name\">DBReader</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>ChampionDBManager 인터페이스를 선언했다. 앞으로 챔피언 DB와 관련된 클래스는 이 인터페이스를 구현해야한다.</p>\n<table>\n<thead>\n<tr>\n<th align=\"center\">Metohd Name</th>\n<th align=\"left\">Description</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td align=\"center\">DBReader</td>\n<td align=\"left\">DB로부터 데이터를 읽어오는 메소드</td>\n</tr>\n<tr>\n<td align=\"center\">parseChampion</td>\n<td align=\"left\">DB로부터 읽어온 데이터를 Champion 객체로 만들어서 반환해주는 메소드</td>\n</tr>\n</tbody>\n</table>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">import</span> <span class=\"token namespace\">java<span class=\"token punctuation\">.</span>io</span><span class=\"token punctuation\">.</span><span class=\"token class-name\">BufferedReader</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">java<span class=\"token punctuation\">.</span>io</span><span class=\"token punctuation\">.</span><span class=\"token class-name\">File</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">java<span class=\"token punctuation\">.</span>io</span><span class=\"token punctuation\">.</span><span class=\"token class-name\">FileNotFoundException</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">java<span class=\"token punctuation\">.</span>io</span><span class=\"token punctuation\">.</span><span class=\"token class-name\">FileReader</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">java<span class=\"token punctuation\">.</span>util<span class=\"token punctuation\">.</span>stream</span><span class=\"token punctuation\">.</span><span class=\"token class-name\">Stream</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">ChampionFileDBManager</span> <span class=\"token keyword\">implements</span> <span class=\"token class-name\">ChampionDBManager</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">String</span> CHAMPION_DB_FILE <span class=\"token operator\">=</span> <span class=\"token string\">\"champion.db\"</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token annotation punctuation\">@Override</span>\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">Champion</span> <span class=\"token function\">parseChampion</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Object</span> iter<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token class-name\">String</span> line <span class=\"token operator\">=</span> <span class=\"token class-name\">String</span><span class=\"token punctuation\">.</span><span class=\"token function\">valueOf</span><span class=\"token punctuation\">(</span>iter<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token class-name\">String</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> championData <span class=\"token operator\">=</span> line<span class=\"token punctuation\">.</span><span class=\"token function\">split</span><span class=\"token punctuation\">(</span><span class=\"token string\">\",\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token keyword\">int</span> index <span class=\"token operator\">=</span> <span class=\"token class-name\">Integer</span><span class=\"token punctuation\">.</span><span class=\"token function\">parseInt</span><span class=\"token punctuation\">(</span>championData<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token class-name\">String</span> name <span class=\"token operator\">=</span> championData<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Champion</span><span class=\"token punctuation\">(</span>name<span class=\"token punctuation\">,</span> index<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token annotation punctuation\">@Override</span>\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">Stream</span> <span class=\"token class-name\">DBReader</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token class-name\">BufferedReader</span> br <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">BufferedReader</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">FileReader</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">File</span><span class=\"token punctuation\">(</span>CHAMPION_DB_FILE<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">return</span> br<span class=\"token punctuation\">.</span><span class=\"token function\">lines</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">FileNotFoundException</span> e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            e<span class=\"token punctuation\">.</span><span class=\"token function\">printStackTrace</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span> \n        <span class=\"token keyword\">return</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>ChampionFileDBManager는 File DB를 채택한 경우 사용할 클래스를 구현체가 된다. 만약 다른 DB를 사용하게 된다면 ChampionMySqlDBManager 클래스 같은걸 ChampionDBManager를 인터페이스로 해서 구현하면 될 것이다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">import</span> <span class=\"token namespace\">java<span class=\"token punctuation\">.</span>util</span><span class=\"token punctuation\">.</span><span class=\"token class-name\">Iterator</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">java<span class=\"token punctuation\">.</span>util<span class=\"token punctuation\">.</span>stream</span><span class=\"token punctuation\">.</span><span class=\"token class-name\">Stream</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">ChampionPoolGenerator</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">private</span> <span class=\"token class-name\">ChampionDBManager</span> championDBManager<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">private</span> <span class=\"token class-name\">Stream</span> dbStream<span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">private</span> <span class=\"token class-name\">ChampionPool</span> championPool<span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">ChampionPoolGenerator</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        championPool <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ChampionPool</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        championDBManager <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ChampionFileDBManager</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">ChampionPool</span> <span class=\"token function\">generate</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        dbStream <span class=\"token operator\">=</span> championDBManager<span class=\"token punctuation\">.</span><span class=\"token class-name\">DBReader</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>dbStream <span class=\"token operator\">==</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Champion DB error!\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">return</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n\n        <span class=\"token class-name\">Iterator</span> iter <span class=\"token operator\">=</span> dbStream<span class=\"token punctuation\">.</span><span class=\"token function\">iterator</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">while</span><span class=\"token punctuation\">(</span>iter<span class=\"token punctuation\">.</span><span class=\"token function\">hasNext</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token class-name\">Champion</span> champion <span class=\"token operator\">=</span> championDBManager<span class=\"token punctuation\">.</span><span class=\"token function\">parseChampion</span><span class=\"token punctuation\">(</span>iter<span class=\"token punctuation\">.</span><span class=\"token function\">next</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            championPool<span class=\"token punctuation\">.</span><span class=\"token function\">registerChampions</span><span class=\"token punctuation\">(</span>champion<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n        <span class=\"token keyword\">return</span> championPool<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>챔피언 풀 생성을 위해 ChampionDBManager 인스턴스를 하나 생성해서 챔피언 정보를 불러온다. DB가 변경됐다면?<br>\n<em>championDBManager = new ChampionFileDBManager();</em> 에서 <em>ChampionFileDBManager만</em> 바꿔주면 될 것 같다.</p>\n<p>이렇게 분리하고 나니 ChampionPoolGenerator가 <em>singleton</em>이어도 문제 없을 것 같다는 생각이 들었다. 챔피언 풀 인스턴스를 찍어내는 기계는 딱 하나만 존재해도 문제 없다.<br>\n단, 여러개의 방에서 동시에 챔피언 풀 생성을 요청하는 경우를 고려해야 한다. generate 내부에서 Iterator 루프가 도는 중에 다른 곳에서 generate를 호출하면 루프에 영향을 주는일이 없는지? synchronized로 해결되는지? 이런거…<br>\n일단은 TODO로</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">#champion.db\n1,가렌\n2,갈리오\n3,갱플랭크\n...\n18,라칸\n19,람머스\n20,럭스</code></pre></div>\n<p>일단 파일에는 (귀찮아서) 20개의 챔피언 정보만 가나다 순으로 등록해뒀다. 그리고 혹시모를 인덱싱을 위해 챔피언 번호도 추가. 파일 포맷이 변경되어도 parseChampion 메소드만 잘 수정하면 다른 곳은 건드릴 필요가 없다.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">--실행화면--\n- 에블바디언더스텐 소환사님 선택 차례 -\n선택 가능 챔피언 목록\n가렌        갈리오       갱플랭크      그라가스      그레이브스     나르        나미        나서스       노틸러스      녹턴        누누와 윌럼프   니달리       니코        다리우스      다이애나      드레이븐      라이즈       라칸        람머스       럭스        \n랜덤 선택 : -1</code></pre></div>\n<p>파일에 추가한대로 챔피언 목록이 잘 출력된다. (선택도 잘 된다.)<br>\n챔피언이 충분하니 이제 3대3으로 간단한 밴픽을 진행해봐도 될 것 같다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token comment\">// Main.java</span>\n<span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n\n<span class=\"token class-name\">Summoner</span> ai1 <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Ai</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"봇1\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token class-name\">Summoner</span> ai2 <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Ai</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"봇2\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token class-name\">Summoner</span> ai3 <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Ai</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"봇3\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nentry<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span>ai1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nentry<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span>ai2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nentry<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span>ai3<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token class-name\">Room</span> room <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Room</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">null</span><span class=\"token punctuation\">,</span> entry<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nroom<span class=\"token punctuation\">.</span><span class=\"token function\">progressBan</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nroom<span class=\"token punctuation\">.</span><span class=\"token function\">progressPick</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nroom<span class=\"token punctuation\">.</span><span class=\"token function\">printBanPickResult</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span></code></pre></div>\n<p>미리 만들어놓은 progressBan() 메소드를 progressPick() 전에 호출해서 밴-픽 순서로 진행을 하고, 결과를 출력해주는 메소드를 하나 만들었다. </p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">=== 밴픽 결과 ===\n금지된 챔피언 목록[3. 갱플랭크, 5. 그레이브스, 8. 나서스, 14. 다리우스, 6. 나르, 13. 니코]\n챔피언 선택 결과\n에블바디언더스텐 님 : 그라가스\nManySolutions 님 : 노틸러스\n바데야 님 : 녹턴\n봇1 님 : 럭스\n봇2 님 : 라이즈\n봇3 님 : 나미</code></pre></div>\n<hr>\n<p>밴픽을 위한 챔피언 풀 준비 단계와, 선택 결과가 제대로 동작한다는 것은 확인했다.<br>\n이제 야매로 구현돼있는 밴픽 부분을 다듬을 차례다.</p>\n<p>일단 밴픽을 진행하기 위해서는 <U>팀이 구성</U>되어야 하고, <U>어떤 순서로 밴픽을 진행</U>할지 결정하기 위한 룰이 필요하다.</p>","frontmatter":{"title":"객체지향 생각해보기 - 밴픽 (3)","date":"August 16, 2019"}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/8/","previous":{"fields":{"slug":"/7/"},"frontmatter":{"title":"Java 디자인 패턴 Study - (5)"}},"next":{"fields":{"slug":"/9/"},"frontmatter":{"title":"Java 디자인 패턴 Study - (6)"}}}}}